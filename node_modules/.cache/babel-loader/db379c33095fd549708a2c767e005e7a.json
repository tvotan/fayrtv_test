{"ast":null,"code":"import _classCallCheck from\"/Users/tinvotan/Projects/fayrtv/fayr_test/fayrtv_test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/tinvotan/Projects/fayrtv/fayr_test/fayrtv_test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/tinvotan/Projects/fayrtv/fayr_test/fayrtv_test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/tinvotan/Projects/fayrtv/fayr_test/fayrtv_test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import{Icon,Progress,Label,Popup}from'semantic-ui-react';import{Slider}from'react-semantic-ui-range';import{formatTimestamp}from'../../utils';// TODO a lot of this state is currently tied to the per-second tsMap update, which is leading to some UI lag\n// Should probably have local state tracking CC/mute/time etc.\nexport var Controls=/*#__PURE__*/function(_React$Component){_inherits(Controls,_React$Component);var _super=_createSuper(Controls);function Controls(){var _this;_classCallCheck(this,Controls);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={showTimestamp:false,currTimestamp:0,posTimestamp:0};_this.onMouseOver=function(){// console.log('mouseover');\n_this.setState({showTimestamp:true});};_this.onMouseOut=function(){// console.log('mouseout');\n_this.setState({showTimestamp:false});};_this.onMouseMove=function(e){var rect=e.target.getBoundingClientRect();var x=e.clientX-rect.left;var max=rect.width;var pct=x/max;// console.log(x, max);\nvar target=pct*_this.props.duration;// console.log(pct);\nif(pct>=0){_this.setState({currTimestamp:target,posTimestamp:pct});}};return _this;}_createClass(Controls,[{key:\"render\",value:function render(){var _this2=this;var _this$props=this.props,togglePlay=_this$props.togglePlay,onSeek=_this$props.onSeek,fullScreen=_this$props.fullScreen,toggleMute=_this$props.toggleMute,toggleSubtitle=_this$props.toggleSubtitle,jumpToLeader=_this$props.jumpToLeader,paused=_this$props.paused,muted=_this$props.muted,subtitled=_this$props.subtitled,currentTime=_this$props.currentTime,duration=_this$props.duration,leaderTime=_this$props.leaderTime;var isBehind=leaderTime&&leaderTime-currentTime>5;return/*#__PURE__*/React.createElement(\"div\",{className:\"controls\"},/*#__PURE__*/React.createElement(Icon,{size:\"large\",onClick:togglePlay,className:\"control action\",disabled:this.props.disabled,name:paused?'play':'pause'}),/*#__PURE__*/React.createElement(Popup,{content:(isBehind?\"We've detected that your stream is behind. \":'')+'Click to sync to leader.',trigger:/*#__PURE__*/React.createElement(Icon,{size:\"large\",onClick:jumpToLeader,className:\"control action \".concat(isBehind?'glowing':''),name:'angle double right'})}),/*#__PURE__*/React.createElement(\"div\",{className:\"control\"},formatTimestamp(currentTime)),/*#__PURE__*/React.createElement(Progress,{size:\"tiny\",color:\"blue\",onClick:duration<Infinity&&!this.props.disabled?onSeek:undefined,onMouseOver:this.onMouseOver,onMouseOut:this.onMouseOut,onMouseMove:this.onMouseMove,className:\"control action\",inverted:true,style:{flexGrow:1,marginTop:0,marginBottom:0,position:'relative',minWidth:'100px'},value:currentTime,total:duration},duration<Infinity&&this.state.showTimestamp&&/*#__PURE__*/React.createElement(\"div\",{style:{position:'absolute',bottom:'0px',left:\"calc(\".concat(this.state.posTimestamp*100+'% - 27px',\")\"),pointerEvents:'none'}},/*#__PURE__*/React.createElement(Label,{basic:true,color:\"blue\",pointing:\"below\"},/*#__PURE__*/React.createElement(\"div\",{style:{width:'34px'}},formatTimestamp(this.state.currTimestamp))))),/*#__PURE__*/React.createElement(\"div\",{className:\"control\"},formatTimestamp(duration)),/*#__PURE__*/React.createElement(Icon,{size:\"large\",onClick:toggleSubtitle,className:\"control action\",name:subtitled?'closed captioning':'closed captioning outline',title:\"Captions\"}),/*#__PURE__*/React.createElement(Icon,{size:\"large\",onClick:function onClick(){return fullScreen(false);},className:\"control action\",name:\"window maximize outline\",title:\"Theater Mode\"}),/*#__PURE__*/React.createElement(Icon,{size:\"large\",onClick:function onClick(){return fullScreen(true);},className:\"control action\",name:\"expand\",title:\"Fullscreen\"}),/*#__PURE__*/React.createElement(Icon,{size:\"large\",onClick:toggleMute,className:\"control action\",name:muted?'volume off':'volume up',title:\"Mute\"}),/*#__PURE__*/React.createElement(\"div\",{style:{width:'100px',marginRight:'10px'}},/*#__PURE__*/React.createElement(Slider,{value:this.props.getVolume(),color:\"blue\",settings:{min:0,max:1,step:0.01,onChange:function onChange(value){_this2.props.setVolume(value);}}})));}}]);return Controls;}(React.Component);","map":{"version":3,"sources":["/Users/tinvotan/Projects/fayrtv/fayr_test/fayrtv_test/src/components/Controls/Controls.tsx"],"names":["React","Icon","Progress","Label","Popup","Slider","formatTimestamp","Controls","state","showTimestamp","currTimestamp","posTimestamp","onMouseOver","setState","onMouseOut","onMouseMove","e","rect","target","getBoundingClientRect","x","clientX","left","max","width","pct","props","duration","togglePlay","onSeek","fullScreen","toggleMute","toggleSubtitle","jumpToLeader","paused","muted","subtitled","currentTime","leaderTime","isBehind","disabled","Infinity","undefined","flexGrow","marginTop","marginBottom","position","minWidth","bottom","pointerEvents","marginRight","getVolume","min","step","onChange","value","setVolume","Component"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { Icon, Progress, Label, Popup } from 'semantic-ui-react';\nimport { Slider } from 'react-semantic-ui-range';\nimport { formatTimestamp } from '../../utils';\n\ninterface ControlsProps {\n  duration: number;\n  togglePlay: Function;\n  onSeek: Function;\n  fullScreen: Function;\n  toggleMute: Function;\n  toggleSubtitle: Function;\n  jumpToLeader: Function;\n  paused: boolean;\n  muted: boolean;\n  subtitled: boolean;\n  currentTime: number;\n  getVolume: Function;\n  setVolume: Function;\n  disabled?: boolean;\n  leaderTime?: number;\n}\n\n// TODO a lot of this state is currently tied to the per-second tsMap update, which is leading to some UI lag\n// Should probably have local state tracking CC/mute/time etc.\nexport class Controls extends React.Component<ControlsProps> {\n  state = {\n    showTimestamp: false,\n    currTimestamp: 0,\n    posTimestamp: 0,\n  };\n\n  onMouseOver = () => {\n    // console.log('mouseover');\n    this.setState({ showTimestamp: true });\n  };\n\n  onMouseOut = () => {\n    // console.log('mouseout');\n    this.setState({ showTimestamp: false });\n  };\n\n  onMouseMove = (e: any) => {\n    const rect = e.target.getBoundingClientRect();\n    const x = e.clientX - rect.left;\n    const max = rect.width;\n    const pct = x / max;\n    // console.log(x, max);\n    const target = pct * this.props.duration;\n    // console.log(pct);\n    if (pct >= 0) {\n      this.setState({ currTimestamp: target, posTimestamp: pct });\n    }\n  };\n\n  render() {\n    const {\n      togglePlay,\n      onSeek,\n      fullScreen,\n      toggleMute,\n      toggleSubtitle,\n      jumpToLeader,\n      paused,\n      muted,\n      subtitled,\n      currentTime,\n      duration,\n      leaderTime,\n    } = this.props;\n    const isBehind = leaderTime && leaderTime - currentTime > 5;\n    return (\n      <div className=\"controls\">\n        <Icon\n          size=\"large\"\n          onClick={togglePlay}\n          className=\"control action\"\n          disabled={this.props.disabled}\n          name={paused ? 'play' : 'pause'}\n        />\n        <Popup\n          content={\n            (isBehind ? \"We've detected that your stream is behind. \" : '') +\n            'Click to sync to leader.'\n          }\n          trigger={\n            <Icon\n              size=\"large\"\n              onClick={jumpToLeader}\n              className={`control action ${isBehind ? 'glowing' : ''}`}\n              name={'angle double right'}\n            />\n          }\n        />\n        <div className=\"control\">{formatTimestamp(currentTime)}</div>\n        <Progress\n          size=\"tiny\"\n          color=\"blue\"\n          onClick={\n            duration < Infinity && !this.props.disabled ? onSeek : undefined\n          }\n          onMouseOver={this.onMouseOver}\n          onMouseOut={this.onMouseOut}\n          onMouseMove={this.onMouseMove}\n          className=\"control action\"\n          inverted\n          style={{\n            flexGrow: 1,\n            marginTop: 0,\n            marginBottom: 0,\n            position: 'relative',\n            minWidth: '100px',\n          }}\n          value={currentTime}\n          total={duration}\n        >\n          {duration < Infinity && this.state.showTimestamp && (\n            <div\n              style={{\n                position: 'absolute',\n                bottom: '0px',\n                left: `calc(${this.state.posTimestamp * 100 + '% - 27px'})`,\n                pointerEvents: 'none',\n              }}\n            >\n              <Label basic color=\"blue\" pointing=\"below\">\n                <div style={{ width: '34px' }}>\n                  {formatTimestamp(this.state.currTimestamp)}\n                </div>\n              </Label>\n            </div>\n          )}\n        </Progress>\n        <div className=\"control\">{formatTimestamp(duration)}</div>\n        <Icon\n          size=\"large\"\n          onClick={toggleSubtitle}\n          className=\"control action\"\n          name={subtitled ? 'closed captioning' : 'closed captioning outline'}\n          title=\"Captions\"\n        />\n        <Icon\n          size=\"large\"\n          onClick={() => fullScreen(false)}\n          className=\"control action\"\n          name=\"window maximize outline\"\n          title=\"Theater Mode\"\n        />\n        <Icon\n          size=\"large\"\n          onClick={() => fullScreen(true)}\n          className=\"control action\"\n          name=\"expand\"\n          title=\"Fullscreen\"\n        />\n        <Icon\n          size=\"large\"\n          onClick={toggleMute}\n          className=\"control action\"\n          name={muted ? 'volume off' : 'volume up'}\n          title=\"Mute\"\n        />\n        <div style={{ width: '100px', marginRight: '10px' }}>\n          <Slider\n            value={this.props.getVolume()}\n            color=\"blue\"\n            settings={{\n              min: 0,\n              max: 1,\n              step: 0.01,\n              onChange: (value: number) => {\n                this.props.setVolume(value);\n              },\n            }}\n          />\n        </div>\n      </div>\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}